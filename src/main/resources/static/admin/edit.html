<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <title>Full example - Editor.md examples</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/editormd.css" />
    <link rel="shortcut icon" href="https://pandao.github.io/editor.md/favicon.ico" type="image/x-icon" />
    <style>
    </style>
</head>
<body>
<div id="layout">
    <header>
        <form method="post" id = "main" name="blogFrom" >

            <div id="test-editormd"></div>
            <div style="width:90%;margin: 10px auto;">


                <v-form-item span="7" label="博客标题" class="text-warning">
                    <input id="blogTitle" type="text" class="form-control" name="title" v-model="mdData.title"/>
                </v-form-item >




                <v-form-item span="7" label="博客标签" class="text-warning">
                    <input id="blogTags" type="text" class="form-control" name="title"  v-model="mdData.tags" />
                </v-form-item >

                <input type="hidden" name="mdText" id = "mdText" />
                <input type="hidden" name="article" id = "article"/>
                <div class="form-group">
                    <label for="blogSubmit" class="text-warning">submit</label>
                    <input id = "blogSubmit" type="submit" class="form-control jcala-input" onclick="updateData()" value="保持"/>
                </div>
            </div>
        </form>
    </header>

    <div class="btns">
        <button id="watch-btn">Watch</button>
        <button id="unwatch-btn">Unwatch</button>
        <button id="fullscreen-btn">全屏(按ESC退出)</button>
        <button id="show-toolbar-btn">展示工具栏</button>
        <button id="close-toolbar-btn">隐藏工具栏</button>
        <button id="toc-menu-btn">ToC Dropdown menu</button>
        <button id="toc-default-btn">ToC default</button>
    </div>
</div>

</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/editormd.js"></script>
<script src="/lib/lib.js"></script>
<script type="text/javascript">


    app.main({

        data : function () {
            return {
                mdData:Object,
                mdText:""

            }
        } ,
        methods : {
            fixMdData:function () {
                var self = this;
                //  var editor = testEditor;
                $.ajax({
                    url:"/admin/update_send_data",
                    type:"get" ,
                    dataType:"json",
                    success:function (data) {
                        self.mdData = data;
                        self.mdText = data.mdText;
                    }

                });
            },
                updateData:function(){
                    var a=document.forms[0];
                    var b,c;
                    a.action="/admin/update.action";
                    a.method="post";
                    b = testEditor.getMarkdown();
                    c = testEditor.getHTML();
                    document.blogFrom.mdText.value=testEditor.getMarkdown();
                    document.blogFrom.article.value = testEditor.getHTML();
                    a.submit()
               }

        } ,
        mounted : function () {
            app.fixMdData();
            var testEditor;
            var temp = vm.mdText;
            $(function() {

                $.get('add.md', function(md){
                    md = temp;
                    testEditor = editormd("test-editormd", {
                        width: "70%",
                        height: 640,
                        path : '../lib/',
                        theme : "default",
                        previewTheme : "default",
                        editorTheme : "default",
                        markdown : md,
                        codeFold : true,
                        saveHTMLToTextarea : true,    // 保存 HTML 到 Textarea
                        searchReplace : true,
                        htmlDecode : "style,script,iframe|on*",            // 开启 HTML 标签解析，为了
                        emoji : true,
                        taskList : true,
                        tocm            : true,         // Using [TOCM]
                        tex : true,                   // 开启科学公式TeX语言支持，默认关闭
                        sequenceDiagram : true,       // 开启时序/序列图支持，默认关闭,
                        imageUpload : true,
                        imageFormats : ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
                        imageUploadURL : "/admin/upload",
                        onload : function() {
                            console.log('onload', this);
                        }
                    });
                });

                $("#watch-btn").bind('click', function() {
                    testEditor.watch();
                });

                $("#unwatch-btn").bind('click', function() {
                    testEditor.unwatch();
                });

                $("#preview-btn").bind('click', function() {
                    testEditor.previewing();
                });

                $("#fullscreen-btn").bind('click', function() {
                    testEditor.fullscreen();
                });

                $("#show-toolbar-btn").bind('click', function() {
                    testEditor.showToolbar();
                });

                $("#close-toolbar-btn").bind('click', function() {
                    testEditor.hideToolbar();
                });


            });

        }
    });







</script>



</html>